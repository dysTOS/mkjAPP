<ng-template #toolbarContentSection>
    <div class="flex justify-content-end mb-3">
        <button
            pButton
            icon="pi pi-times"
            class="p-button-text"
            (click)="
                toolbarService.contentSectionExpanded = false;
                toolbarService.buttons[0].highlighted = false
            "
        ></button>
    </div>
    <div class="flex gap-2 justify-content-center align-items-center">
        <p-selectButton
            [options]="mitgliederFilter"
            [(ngModel)]="selectedFilter"
            (ngModelChange)="
                $event.value === 'alle'
                    ? loadAllMitglieder()
                    : loadAktiveMitglieder()
            "
            optionLabel="name"
        ></p-selectButton>
    </div>
    <p-divider></p-divider>
    <div class="flex flex-wrap justify-content-between align-items-center">
        <div>
            Anzahl:
            {{ mitglieder?.length ?? 0 }}
        </div>

        <span class="p-input-icon-left">
            <i class="pi pi-search"></i>
            <input
                pInputText
                type="text"
                [value]="mitgliederTable.filters?.global?.value"
                (input)="
                    mitgliederTable.filterGlobal(
                        $event.target.value,
                        'contains'
                    )
                "
                placeholder="Suchen..."
            />
        </span>
    </div>
</ng-template>

<div class="grid">
    <div class="col-12">
        <p-table
            #mitgliederTable
            [value]="mitglieder"
            [loading]="loading"
            [globalFilterFields]="['vorname', 'zuname', 'email']"
            responsiveLayout="stack"
            styleClass="p-datatable-sm p-datatable-mitglieder p-datatable-striped"
        >
            <ng-template pTemplate="header" let-columns>
                <tr>
                    <th pSortableColumn="zuname">
                        Name <p-sortIcon field="zuname"></p-sortIcon>
                    </th>
                    <th class="not-on-small">Adresse</th>
                    <th>E-Mail</th>
                    <th class="not-on-small">Mobil-Nr.</th>
                    <th></th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-mitglied let-columns="columns">
                <tr [pSelectableRow]="mitglied">
                    <td>
                        <b>{{ mitglied?.vorname }} {{ mitglied?.zuname }}</b>

                        <button
                            *visibleFor="[PermissionMap.MITGLIEDER_SAVE]"
                            pButton
                            (click)="navigateSingleMitglied(mitglied)"
                            pTooltip="Details"
                            tooltipPosition="left"
                            icon="pi pi-ellipsis-h"
                            class="just-on-small p-button-sm p-button-outlined p-button-rounded buttons-hide p-button-info"
                        ></button>
                    </td>
                    <td>
                        {{ mitglied?.strasse }} {{ mitglied?.hausnummer }}
                        {{ mitglied?.plz }} {{ mitglied?.ort }}
                    </td>
                    <td>{{ mitglied?.email }}</td>
                    <td>{{ mitglied.telefonMobil }}</td>
                    <td class="not-on-small">
                        <button
                            *visibleFor="[PermissionMap.MITGLIEDER_SAVE]"
                            pButton
                            (click)="navigateSingleMitglied(mitglied)"
                            pTooltip="Details"
                            tooltipPosition="left"
                            icon="pi pi-ellipsis-h"
                            class="p-button-sm p-button-outlined p-button-rounded buttons-hide p-button-info p-2"
                        ></button>
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>
</div>
